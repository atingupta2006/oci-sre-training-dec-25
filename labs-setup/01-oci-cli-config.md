# **OCI CLI Setup Runbook (Ubuntu 24.04)**

### *(Updated & Corrected for Terraform Compatibility)*

## **1. Update System Packages**

```bash
sudo apt update
```

---

## **2. Install Required Dependencies**

```bash
sudo apt install -y python3 python3-venv python3-pip unzip software-properties-common gnupg2
```

---

## **3. Install OCI CLI**

Use Oracle’s official installer:

```bash
bash -c "$(curl -L https://raw.githubusercontent.com/oracle/oci-cli/master/scripts/install/install.sh)"
```

Reload the shell:

```bash
source ~/.bashrc
```

---

## **4. Verify OCI CLI Installation**

```bash
oci --version
```

---

## **5. Create an Unencrypted OCI API Key Pair (Required for Terraform)**

Terraform **cannot** work with encrypted private keys.
So instead of using the autogenerated encrypted key, generate your own unencrypted key pair:

```bash
mkdir -p ~/.oci
openssl genrsa -out ~/.oci/oci_api_key_unencrypted.pem 2048
chmod 600 ~/.oci/oci_api_key_unencrypted.pem
openssl rsa -pubout -in ~/.oci/oci_api_key_unencrypted.pem \
  -out ~/.oci/oci_api_key_unencrypted_public.pem
```

---

## **6. Upload the Public Key to OCI Console**

Display the public key:

```bash
cat ~/.oci/oci_api_key_unencrypted_public.pem
```

Then go to:

**OCI Console → User Menu → Identity → Users → Your User → API Keys → Add Public Key**

Paste the public key and click **Add**.

Copy the **fingerprint** OCI provides — you will need it for your config.

---

## **7. Configure OCI CLI**

Set up the configuration file:

```bash
nano ~/.oci/config
```

Use this template (update with your real values):

```
[DEFAULT]
user=<your user OCID>
tenancy=<your tenancy OCID>
region=ap-mumbai-1
fingerprint=<fingerprint for the unencrypted key>
key_file=/home/adminuser/.oci/oci_api_key_unencrypted.pem
```

**Important:**

* Do **NOT** include `pass_phrase`
* Do **NOT** use `.pem` files from the automated `oci setup config` unless unencrypted

Save and exit.

---

## **8. Verify Correct Permissions**

```bash
chmod 600 ~/.oci/oci_api_key_unencrypted.pem
```

---

## **9. Test OCI CLI Authentication**

```bash
oci iam region list
```

If it prints regions → OCI CLI is correctly configured.

---

# ✔ You are now ready to use Terraform with OCI

Terraform will automatically use:

```
~/.oci/config
```

and the **unencrypted** private key:

```
oci_api_key_unencrypted.pem
```
